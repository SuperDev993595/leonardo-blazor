@using MudBlazor
@* Reusable auth form field using MudBlazor while preserving the project's visual style *@
<div class="form-group">
    <label for="@Id">@Label</label>
    <div class="input-wrapper">
        @if (!string.IsNullOrEmpty(LeftIconClass))
        {
            <i class="@LeftIconClass left" aria-hidden="true"></i>
        }

        @if (ShowPasswordToggle)
        {
            <MudTextField T="string"
                          Id="@Id"
                          @bind-Value="CurrentValue"
                          Placeholder="@Placeholder"
                          Variant="Variant.Text"
                          InputClass="auth-input"
                          InputType="@ActualInputType"
                          Adornment="Adornment.End"
                          AdornmentIcon="@(showPassword ? "fa-regular fa-eye-slash" : "fa-regular fa-eye")"
                          OnAdornmentClick="TogglePasswordVisibility" />
        }
        else
        {
            <MudTextField T="string"
                          Id="@Id"
                          @bind-Value="CurrentValue"
                          Placeholder="@Placeholder"
                          Variant="Variant.Text"
                          InputClass="auth-input"
                          InputType="@ActualInputType" />
        }

    </div>
</div>

@code {
    [Parameter] public string Id { get; set; } = "";
    [Parameter] public string Label { get; set; } = "";
    [Parameter] public string Placeholder { get; set; } = "";
    [Parameter] public InputType InputType { get; set; } = InputType.Text;
    [Parameter] public string? LeftIconClass { get; set; }
    [Parameter] public bool ShowPasswordToggle { get; set; }
    [Parameter] public RenderFragment? BottomContent { get; set; }

    [Parameter] public string? Value { get; set; }
    [Parameter] public EventCallback<string?> ValueChanged { get; set; }

    private bool showPassword;
    private InputType ActualInputType => ShowPasswordToggle ? (showPassword ? InputType.Text : InputType.Password) : InputType;

    private string? CurrentValue
    {
        get => Value;
        set => ValueChanged.InvokeAsync(value);
    }

    private void TogglePasswordVisibility() => showPassword = !showPassword;
}
